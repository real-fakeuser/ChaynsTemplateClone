import loadScript from './loadScript';
import loadStyle from './loadStyle';

export default function loadOptionalDependency(module, windowModule, jsArray, cssArray) {
    var returnPromise = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : true;

    var emojione = null;
    try {
        // eslint-disable-next-line global-require,import/no-dynamic-require
        emojione = require(module);
    } catch (ex) {
        emojione = window[windowModule];
    }

    if (emojione) {
        if (returnPromise) {
            return Promise.resolve(emojione);
        }

        return emojione;
    }

    var loadArray = [];

    if (!emojione) {
        for (var i = 0, z = jsArray.length; i < z; i += 1) {
            loadArray.push(loadScript(jsArray[i], jsArray[i]));
        }

        for (var _i = 0, _z = cssArray.length; _i < _z; _i += 1) {
            loadArray.push(loadStyle(cssArray[_i], cssArray[_i]));
        }
    }

    if (returnPromise) {
        return Promise.all(loadArray);
    }

    return emojione;
}